@using Newtonsoft.Json;
@using Re.Core.Models
@using Re.UI.Data
@using CColor = System.Drawing.Color

<MudGrid>
    <MudItem xs="8">
        <MudText Align="Align.Center">Отделение анестезиологии-реанимации</MudText>
        <MudGrid Spacing="10" Justify="Justify.Center">
            <MudItem>
                <MudDatePicker style="width: 150px;" Label="Дата" @bind-Date="date" />
            </MudItem>
            <MudItem>
                <MudTimePicker style="width: 150px;" Label="Время" @bind-Time="time" />
            </MudItem>
        </MudGrid>
        <MudPaper Style="padding: 10px; margin: 15px 0">
            <MudText Align="Align.Center" Typo="Typo.h5">@re.Name</MudText>
            <MudSelect T="string" Label="Пациент доставлен в реанимационное отделение из" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.DeliveredFrom)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudSelect T="string" Label="ИВЛ при транспортировке" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.AVLDueTransportation)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudSelect T="string" Label="Жалобы:" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.Complaints)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudGrid Justify="Justify.FlexStart" Style="align-items: flex-end;">
                <MudItem xs="7">
                    <MudTextField T="string" Label="Жалобы на" Variant="Variant.Text" Text="@re.Features" />
                </MudItem>
                <MudItem Style="padding: 12px 0;" xs="2">
                    <MudSwitch Class="d-flex justify-end" @bind-Checked="@IsVashOn" Color="Color.Primary"
                               Label="ВАШ - "></MudSwitch>
                </MudItem>
                @if (IsVashOn)
                {
                    <MudItem xs="3">
                        <MudSelect T="string">
                            @foreach (var item in re.Vash)
                            {
                                <MudSelectItem Style="margin-bottom: 15px;" Value="@item" />
                            }
                        </MudSelect>
                    </MudItem>
                }
            </MudGrid>
            <MudText Style="font-weight: bold; padding-top: 10px;">Объективно</MudText>
            <MudSelect T="string" Label="Состояние" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.Condition)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudGrid>
                <MudItem xs="6">
                    <MudSelect T="string" Label="Сознание:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.Conscience)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem xs="6">
                    <MudSelect T="string" Label="Ramsey:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.Ramsey)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
            </MudGrid>
            <MudSelect T="string" Label="Мышечный тонус" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.MuscleTone)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudGrid>
                <MudItem Style="width: 20%; padding-right: 6px;" Class="d-flex flex-column justify-end"><MudText>Кожные покровы</MudText></MudItem>
                <MudItem Style="width: 33%; padding: 12px 6px;">
                    <MudSelect T="string" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.SkinCovers[0])
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem Style="width: 16%; padding: 12px 6px;">
                    <MudSelect T="string" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.SkinCovers[1])
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem Style="width: 31%;">
                    <MudSelect T="string" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.SkinCovers[2])
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
            </MudGrid>

            <MudGrid>
                <MudItem Style="padding-top: 0;" xs="6">
                    <MudSelect T="string" Label="Цианоз:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.Cyanosis)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem Style="padding-top: 0;" xs="6">
                    <MudSelect T="string" Label="Мраморность:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.Marbling)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
            </MudGrid>
            <MudSelect T="string" Label="Периферические отеки:" AnchorOrigin="Origin.BottomCenter">
                @foreach (var item in re.PeripheralEdema)
                {
                    <MudSelectItem Value="@item" />
                }
            </MudSelect>
            <MudGrid>
                <MudItem xs="2" Class="d-flex flex-column justify-end"><MudText>В/в катетер -</MudText></MudItem>
                <MudItem xs="5">
                    <MudSelect T="string" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.VeinsToBeCatheterized[0])
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem xs="5">
                    <MudSelect T="string" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.VeinsToBeCatheterized[1])
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
            </MudGrid>
            <MudGrid>
                <MudItem Style="padding-top: 0;" xs="7">
                    <MudSelect T="string" Label="Признаки воспаления в области катетера:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.InflammationInCatheter)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem Style="padding-top: 0;" xs="5">
                    <MudSelect T="string" Label="Спонтанное дыхание:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.SpontaneousBreathing)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                
            </MudGrid>
            <MudGrid>
                <MudItem Style="padding-top: 0;" xs="6">
                    <MudSelect T="string" Label="Дыхание через:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.BreathingThrough)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                <MudItem Style="padding-top: 0;" xs="6">
                    <MudSelect T="string" Label="Нарушение дыхания:" AnchorOrigin="Origin.BottomCenter">
                        @foreach (var item in re.BreathingDisorder)
                        {
                            <MudSelectItem Value="@item" />
                        }
                    </MudSelect>
                </MudItem>
                @if (!IsIVL)
                {
                    <MudItem Class="d-flex flex-column justify-center" xs="1">
                        <MudText>ЧДД</MudText>
                    </MudItem>
                    <MudItem Style="padding-top: 0;" xs="2">
                        <MudNumericField Style="margin-top: 0" HideSpinButtons="true" @bind-Value="re.RespiratoryRate" Variant="Variant.Text" Min="0"></MudNumericField>
                    </MudItem>
                    <MudItem Class="d-flex flex-column justify-center" xs="3">
                        <MudText>в 1 минуту</MudText>
                    </MudItem>
                }
            </MudGrid>
        </MudPaper>
    </MudItem>
    <MudItem xs="4">
        <MudGrid>
            <MudItem>
                <MudBadge Color="Color.Error" Origin="Origin.TopCenter" Overlap="true" Content="@robodoc">
                    <MudPaper Class="d-flex flex-column justify-center" Style="background-color: #D9D9D9; border: 1px solid #C00000;"
                              Height="140px" Width="180px">
                        <MudButtonGroup Style="margin: 1rem;" Variant="Variant.Outlined" Size="Size.Large" VerticalAlign="true">
                            <MudButton Style="justify-content: space-between" OnClick="HandleWithoutIVL">
                                <MudImage Width="20" Src="../img/robot.png" />
                                Без ИВЛ
                            </MudButton>
                            <MudButton Style="justify-content: space-between" OnClick="HandleWithIVL">
                                <MudImage Width="20" Src="../img/robot.png" />
                                С ИВЛ
                            </MudButton>
                        </MudButtonGroup>
                    </MudPaper>
                </MudBadge>
            </MudItem>
        </MudGrid>
        
        
    </MudItem>
</MudGrid>

@code {
    // Относительный путь
    ReceptionEpicrisis re = 
    JsonConvert.DeserializeObject<ReceptionEpicrisis>(File.ReadAllText
        ("./wwwroot/json/epic.reception.json"));
    DateTime? date = DateTime.Now;
    TimeSpan? time = DateTime.Now.TimeOfDay;

    public bool IsVashOn { get; set; } = false;
    public bool IsIVL { get; set; } = false;
    public string robodoc = "\t ROBODOC \t";

    void HandleWithIVL() => IsIVL = true;
    void HandleWithoutIVL() => IsIVL = false;
}